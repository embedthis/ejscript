{
    title: 'Application Generator',
    crumbs: [
        { 'Web Framework Guide': 'index.html'} ,
    ]
}
            <h1>Application Generator &mdash; mvc</h1>
            <p>Ejscript provides an application generator and manager, called <b>mvc</b>. This tool makes it easier
            and quicker to create and manage your web applications. The <b>mvc</b> command generates Ejscript web
            applications, database migrations, database models, scaffolds and views.</p>
            <p>Mvc will create directories and generate configuration and source code files which can then be
            manually edited as required. Mvc is intelligent and will not overwrite existing files, so you can safely
            edit and regenerate without losing your changes. You can overwrite your changes if you wish to by using the
            <b>--overwrite</b> switch.</p>
            <p>Mvc can also be used to run your application by invoking a configured web server.</p><a id="app"></a>
            <h2 >Generating Applications</h2>
            <p>To start a new web application, run <b>mvc</b> to create the application directory and generate the
            essential application configuration and script files. For example:</p>
            <pre class="ui code segment">
mvc generate app myApp
</pre>
            <h3>Created Directories</h3>
            <p>This will create the following directories. Most of these directories are initially empty, but may be
            used over time. Ejscript follows conventions where specific files are stored. This greatly simplifies
            configuring a web application.</p>
            <table title="Directories" class="ui table segment">
                <thead>
                    <tr>
                        <th>Directory</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>cache</td>
                        <td>Compiled views and web pages</td>
                    </tr>
                    <tr>
                        <td>controllers</td>
                        <td>Controller source</td>
                    </tr>
                    <tr>
                        <td>db</td>
                        <td>Databases and scripts</td>
                    </tr>
                    <tr>
                        <td>db/migrations</td>
                        <td>Database migration scripts</td>
                    </tr>
                    <tr>
                        <td>layouts</td>
                        <td>View layout files</td>
                    </tr>
                    <tr>
                        <td>models</td>
                        <td>Database model code</td>
                    </tr>
                    <tr>
                        <td>src</td>
                        <td>Extra application source code</td>
                    </tr>
                    <tr>
                        <td>static</td>
                        <td>Static web page directory</td>
                    </tr>
                    <tr>
                        <td>static/images</td>
                        <td>Static images</td>
                    </tr>
                    <tr>
                        <td>static/js</td>
                        <td>Client side JavaScripts</td>
                    </tr>
                    <tr>
                        <td>Application/themes</td>
                        <td>Application HTML themes</td>
                    </tr>
                    <tr>
                        <td>views</td>
                        <td>View source files</td>
                    </tr>
                </tbody>
            </table>
            <p>Mvc will also create some files which have the following meaning:</p>
            <table title="Files" class="ui table segment">
                <thead>
                    <tr>
                        <th>Files</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>controllers/Base.es</td>
                        <td>Application base controller class</td>
                    </tr>
                    <tr>
                        <td>ejsrc</td>
                        <td>Application configuration file</td>
                    </tr>
                    <tr>
                        <td>layouts/default.ejs</td>
                        <td>Default layout web page</td>
                    </tr>
                    <tr>
                        <td>static/themes/default.css</td>
                        <td>Default theme CSS file</td>
                    </tr>
                    <tr>
                        <td>static/layout.css</td>
                        <td>Default layout CSS file</td>
                    </tr>
                </tbody>
            </table>
            
            <a id="controllers"></a>
            <h2 >Generating Controllers</h2>
            <p>Controllers are the primary mechanism for responding to client requests. To generate a controller:</p>
            <pre class="ui code segment">
mvc generate controller NAME [actions...]
</pre>
            <p>This will create the named controller in the <em>controllers</em> directory. A controller manages the
            web application and the controller action methods are invoked by Ejscript to respond to client requests and
            generate responses.</p>
            <p>If no actions are requested, mvc will create a default <em>index</em> action method. If other actions
            are requested, mvc will create an empty action method for each requested action. You can edit the
            controller source to meet your needs.</p>
            <p>If you use the command:</p>
            <pre class="ui code segment">
mvc generate controller Admin edit login logout command.
</pre>The following controller code will be generated.
            <pre class="ui code segment">
public class AdminController extends BaseController {
    function AdminController() { 
    }
    action function edit() {
    }
    action function login() {
    }
    action function logout() {
    }
}
</pre><a id="models"></a>
            <h2 >Generating Models</h2>
            <p>Database models are Ejscript classes that encapsulate database data and provide access methods. They
            provide a conduit to interact with the database. To generate a model:</p>
            <pre class="ui code segment">
mvc generate model MODEL [field:type ...]
</pre>
            <p>This will create a database model and will generate a model class under the <em>models</em> directory.
            It will also create a database migration to create a database table of the same name as the model.</p>
            <p>If <em>field:type</em> values are supplied, the database migration will include code to create a column
            for each specified field of the requested type. The valid database types are: binary, boolean, date,
            datetime, decimal, float, integer, number, string, text, time, timestamp. <a id="scaffolds"></a></p>
            <h2 >Generating Scaffolds</h2>
            <p>A scaffold is a generated database migration, database model, controller and a set of views that provide
            add, edit and list functionality for a database model. Scaffolds are useful to quickly generate prototype
            web pages and actions for managing a database table. To generate a scaffold:</p>
            <pre class="ui code segment">
mvc generate scaffold MODEL [field:type ...]
</pre>
            <p>This will create a scaffold for the database model and will generate a controller of the same name. If
            field:type values are supplied, the database migration will include code to create a database column for
            each specified field of the requested type. The valid database types are: binary, boolean, date, datetime,
            decimal, float, integer, number, string, text, time, timestamp. The scaffold will include an edit action
            and view page that provides add and edit capability. The list action and view, provides the ability to list
            the database table rows and select an entry to edit.</p>
            <p>You can use the --apply switch to apply the generated database migration and upgrade the
            database.</p><a id="migrations"></a>
            <h2 >Generating Migrations</h2>
            <p>Database migrations are scripts which modify the database schema or content. You can create database
            migrations by the "<em>mvc generate migration</em>" command. This command generates a migration for a
            specific model by creating or removing tables and columns. To generate a migration:</p>
            <pre class="ui code segment">
mvc generate migration description MODEL [field:type ...]
</pre>
            <p>This will create a migration script under the db/migrations directory. Migration scripts filenames are
            time stamped and use the description as part of the filename for the migration script (so keep it short and
            sweet).</p>
            <p>For each specified <em>field:type</em> pair, mvc will generate add column code in the migration
            script. If the --reverse switch is specified, then remove column code will be generated. To change the type
            or name of a column, remove then re-add the column. <a id="runMigrations"></a></p>
            <h2 >Running Migrations</h2>
            <p>Migration scripts can be run via the "<em>mvc migrate</em>" command. Without other parameters, the
            command will run all migrations that have not yet been applied to the database. You can also use
            "<em>mvc migrate forward</em>" to apply the next unapplied migration. Similarly, "<em>mvc migrate
            backward</em>" will reverse the last applied migration. You can also use "<em>mvc migrate NNN</em>" to
            migrate forward or backward to a specific migration. NNN is the migration sequence number which is the
            number at the start of the migration script file name.</p><a id="compiling"></a>
            <h2 >Compiling</h2>
            <p>Ejscript compiles models, views and controllers into Ejscript byte code modules. These are then loaded
            and run by Ejscript in response to incoming client requests. Code is compiled only once but can be run many
            times to service incoming requests.</p>
            <p>In development mode, Ejscript will automatically compile the relevant portions of the application if the
            source code is modified. It can intelligently recompile views, actions, controllers and database models as
            required. However, you can also explicitly recompile portions or the complete application.</p>
            <h3>Compile Everything</h3>
            <p>Mvc can recompile everything via:</p>
            <pre class="ui code segment">
mvc compile ...
</pre>
            <p>This will compile each controller and view and also recompile the application and module source code.
            Module files for each component will be generated.</p>
            <h3>Compile Views and Controllers</h3>
            <p>Mvc also provides options for you to individually compile controllers and views. To recompile named
            views or controllers:</p>
            <pre class="ui code segment">
mvc compile view NAMES...
mvc compile controller NAMES...
</pre>
            <p>When compiling views, you can use the <em>--keep</em> switch to preserve the intermediate generated
            Ejscript source file. This can sometimes be helpful for debugging.</p>
            <h3>Compile Models and Application Code</h3>
            <p>Models are compiled with application code into a single module file. To recompile the models and
            application source code:</p>
            <pre class="ui code segment">
mvc compile app
</pre>
            <h3>Compile Application as One Module</h3>
            <p>To compile the entire application and produce a single module file:</p>
            <pre class="ui code segment">
mvc compile all
</pre>
            <h3>Compile Stand-Alone Web Pages</h3>
            <p>To compile stand-alone Ejscript web pages:</p>
            <pre class="ui code segment">
mvc compile path/name.ejs...
</pre><a id="running"></a>
            <h2 >Running</h2>
            <p>To run your application:</p>
            <pre class="ui code segment">
mvc run
</pre>
            <p>This requires that your config/config.ecf file be modified to define command to run your web
            server.</p><a id="cleaning"></a>
            <h2 >Cleaning</h2>
            <p>To clean all generated module files:</p>
            <pre class="ui code segment">
mvc clean
</pre><a id="options"></a>
            <h2 >Command Options</h2>
            <p>Mvc has the following command usage patterns:</p>
            <pre class="ui code segment">
mvc clean
mvc compile [all | app | controller names... | model names... | view names...]
mvc compile path/name.ejs...
mvc generate app name
mvc generate controller name [actions...]
mvc generate migration description model [field:type...]
mvc generate model name
mvc generate scaffold model [field:type ...]
mvc migrate [forward|backward|NNN]
mvc run
</pre>
            <table title="details" class="ui table segment">
                <thead>
                    <tr>
                        <th class="four wide">Switch</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="nowrap">--apply</td>
                        <td>Apply the database migration when generating a scaffold. This is the same as running
                        <em>mvc migrate</em>.</td>
                    </tr>
                    <tr>
                        <td class="nowrap">--database connector</td>
                        <td>Select a database connector to use. Currently, this switch is not implemented and sqlite is
                        the only connector supported.</td>
                    </tr>
                    <tr>
                        <td>--keep</td>
                        <td>Preserve generated intermediate Ejscript source files. These files are generated when
                        blending views with layout pages.</td>
                    </tr>
                    <tr>
                        <td>--layout layoutPage</td>
                        <td>Change the name of the default layout page if a view does not explicitly specify a layout
                        page.</td>
                    </tr>
                    <tr>
                        <td>--overwrite</td>
                        <td>Overwrite existing files. Mvc normally will not overwrite existing files. This is to
                        preserve user changes to previously generated files.</td>
                    </tr>
                    <tr>
                        <td>--reverse</td>
                        <td>Reverse the operation when generating a migration. Instead of adding tables or columns,
                        this switch will modify the migration to remove them.</td>
                    </tr>
                    <tr>
                        <td>--quiet or -q</td>
                        <td>Run quietly and don't trace actions to the console.</td>
                    </tr>
                    <tr>
                        <td>--verbose or -v</td>
                        <td>Run in verbose mode and trace actions to the console (default).</td>
                    </tr>
                </tbody>
            </table>
