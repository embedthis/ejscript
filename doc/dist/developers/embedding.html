<!DOCTYPE html>
<html lang="en">
<head>
    <title>Embedding</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="description" content="Ejscript JavaScript language">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Open+Sans:300italic,400,300,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Julius+Sans+One' rel='stylesheet' type='text/css'>
    
    <link href="../images/favicon.ico" rel="shortcut icon">
    <link href="../lib/semantic-ui/semantic.min.css" rel="stylesheet" type="text/css">
    <link href="../css/all.min.css" rel="stylesheet" type="text/css">
    <link href="../css/api.min.css" rel="stylesheet" type="text/css">
    

</head>
<body class="show-sidebar">
    <div class="sidebar">
        <div class="ui large left vertical inverted labeled menu">
            <div class="item">
                <a href="../index.html" class="logo">Ejscript Docs</a>
            </div>
            <div class="item">
                <a href="../index.html">
                    <b>General</b>
                </a>
                <div class="menu">
                    <a class="item" href="../index.html">Ejscript Overview</a>
                    <a class="item" href="../users/features.html">Ejscript Features</a>
                    
                    <a class="item" href="../licensing/index.html">Licensing</a>
                </div>
            </div>
            <div class="item">
                <a href="../start/index.html">
                    <b>Getting Started</b>
                </a>
                <div class="menu">
                    <a class="item" href="../start/quick.html">Quick Start</a>
                    <a class="item" href="../start/installing.html">Installing Ejscript</a>
                    <a class="item" href="../start/tour.html">Language Tour</a>
                    <a class="item" href="../start/faq.html">FAQ</a>
                    <a class="item" href="../start/releaseNotes.html">Release Notes</a>
                    <a class="item" href="../start/source.html">Building from Source</a>
                </div>
            </div>
            <div class="item">
                <a href="../users/index.html"><b>User's Guide</b></a>
                <div class="menu">
                    <a class="item" href="../users/shell.html">Using the Command Shell</a>
                    <a class="item" href="../users/compiler.html">Using the Compiler</a>
                    <a class="item" href="../users/ejsmod.html">Using the Module Generator</a>
                    <a class="item" href="../users/doc.html">Generating Documentation</a>
                    <a class="item" href="../users/listing.html">Generating Listing</a>
                    <a class="item" href="../users/man.html">Man Pages</a>
                </div>
            </div>
            <div class="item">
                <a href="../language/index.html"><b>Language Guide</b></a>
                <div class="menu">
                    <a class="item" href="../language/syntax.html">Language Syntax</a>
                    <a class="item" href="../language/statements.html">Statements</a>
                    <a class="item" href="../language/expressions.html">Expressions and Operators</a>
                    <a class="item" href="../language/objects.html">Object and Arrays</a>
                    <a class="item" href="../language/functions.html">Functions and Methods</a>
                    <a class="item" href="../language/core.html">Core Language Types</a>
                    <a class="item" href="../language/types.html">Types and Declarations</a>
                    <a class="item" href="../language/classes.html">Classes and Instances</a>
                    <a class="item" href="../language/modules.html">Modules and Namespaces</a>
                    <a class="item" href="../language/library.html">System Library</a>
                    <a class="item" href="../language/events.html">Events and Timers</a>
                    <a class="item" href="../language/modes.html">Language Modes</a>
                    <a class="item" href="../language/globals.html">Globals</a>
                </div>
            </div>
            <div class="item">
                <a href="../web/index.html"><b>Web Framework Guide</b></a>
                <div class="menu">
                    <a class="item" href="../web/webTour.html">Web Framework Tour</a>
                    <a class="item" href="../web/generator.html">Application Generator</a>
                    <a class="item" href="../web/routing.html">Routing</a>
                    <a class="item" href="../web/controllers.html">Controllers</a>
                    <a class="item" href="../web/views.html">Views and Layout Templates</a>
                    <a class="item" href="../web/controls.html">Ajax View Controls</a>
                    <a class="item" href="../web/models.html">Database Models</a>
                    <a class="item" href="../web/hosting.html">Hosting in Web Servers</a>
                </div>
            </div>
            <div class="item">
                <a href="../developers/index.html">Developer's Guide</a>
                <div class="menu">
                    <a class="item" href="../developers/embedding.html">Embedding Ejscript</a>
                    <a class="item" href="../developers/extending.html">Extending Ejscript</a>
                </div>
            </div>
            <div class="item">
                <a href="../ref/index.html">Reference Guide</a>
                <div class="menu">
                    <a class="item" href="../ref/compatibility.html">Compatibility</a>
                    <a class="item" href="../ref/native.html">Native APIs</a>
                    <a class="item" href="../ref/api/ejscript/index.html" target="new">Script Library</a>
                    <a class="item" href="../ref/architecture.html">Ejscript Architecture</a>
                    <a class="item" href="../ref/webArchitecture.html">Web Framework Architecture</a>
                    <a class="item" href="../ref/memory.html">Ejscript Memory Allocation</a>
                    <a class="item" href="../ref/multithread.html">Multithreaded Programming</a>
                    <a class="item" href="../standards/references.html">Standards</a>
                </div>
            </div>
            <div class="item">
                <a href="../developers/project.html">Project Resources</a>
                <div class="menu">
                    <a class="item" href="https://www.embedthis.com/blog/categories/Ejscript/">Official Ejscript News</a>
                    <a class="item" href="https://www.embedthis.com/ejscript/">Ejscript Web Site</a>
                    <a class="item" href="https://github.com/embedthis/ejs">Source Code Repository</a>
                    <a class="item" href="https://github.com/embedthis/ejs/issues">Project Issue Database</a>
                    <a class="item" href="https://github.com/embedthis/ejs/releases">Change Log</a>
                    <a class="item" href="https://github.com/embedthis/ejs/milestones">Roadmap</a>
                    
                </div>
            </div>
            <div class="item">
                <b>Links</b>
                <div class="menu">
                    <a class="item" href="https://www.embedthis.com/">Embedthis Web Site</a>
                    <a class="item" href="https://www.embedthis.com/blog/">Embedthis Blog</a>
                    <a class="item" href="http://twitter.com/embedthat">Twitter</a>
                </div>
            </div>
        </div>
    </div>




    <div class="ui inverted masthead">
        <div class="ui fixed inverted menu">
            <div class="ui sidebar-launch button">
                <i class="icon list layout"></i>
            </div>
            <div class="right menu">
                <a class="item" href="https://www.embedthis.com/">Embedthis</a>
                    <a class="item" href="https://www.embedthis.com/ejscript/">Ejscript Site</a>
                    <span class="desktop-only">
                        <a class="item" href="https://www.embedthis.com/blog/categories/Ejscript/">Ejscript News</a>
                        <a class="item" href="https://github.com/embedthis/ejs">Repository</a>
                        <a class="item" href="https://www.embedthis.com/blog/">Blog</a>
                        <a class="item" href="https://twitter.com/embedthat">Twitter</a>
                    </span>

            </div>
        </div>
        
        <div class="ui breadcrumb">
            <a class="section" href="../">Home</a>
            
            <div class="divider">/</div>
            <a class="section" href="index.html">
                Developer's Guide
            </a>
            
            
            <div class="divider">/</div>
            <a class="active section" href="embedding.html">Embedding</a>
            
        </div>
        
        <iframe class="version desktop-only" src="../version.html"></iframe>

    </div>
    <div class="content">

            <h1>Embedding Ejscript</h1>
            <p>It is easy to embed Ejscript into an application. Ejscript provides two levels of embedding APIs:</p>
            <ul>
                <li>One line embedding APIs</li>
                <li>Full control APIs</li>
            </ul><a id="oneLine"></a>
            <h2>One Line Embedding</h2>
            <p>Ejscript provides three variety of one-line embedding APIs. These permit you to evaluate a script file,
            a script literal or a pre-compiled script module.</p><a id="file"></a>
            <h3>Evaluate a Script File</h3>
            <p>To create an application that can evaluate script files, use the <b>ejsEvalFile</b> API.</p>
            <pre class="ui code segment">
#include    "ejs/ejs.h"
int main(int argc, char **argv) 
{
    <b>if (ejsEvalFile("test.es") &lt; 0) {</b>
        fprintf(stderr, "Error executing test.es\n");
        exit(1);
    }
    return 0;
}
</pre>
            <p>To build this program, you just need to compile and link with Ejscript compiler library <b>libejs</b>.
            Here is the command for building such a test program called <b>main.c</b> on a MAC system.</p>
            <pre class="ui code segment">
cc -o main main.c -lejs
</pre>
            <a id="literal"></a>
            <h3>Evaluate a Script Literal</h3>
            <p>To create an application that can evaluate script literals, use the <b>ejsEvalScript</b> API.</p>
            <pre class="ui code segment">
#include    "ejs/ejs.h"
int main(int argc, char **argv) 
{
    if (argc != 2) {
        fprintf(stderr, "usage: main script\n");
        exit(1);
    }
    <b>if (ejsEvalScript(argv[1]) &lt; 0) {</b>
        fprintf(stderr, "Error executing %s\n", argv[1]);
        exit(1);
    }
    return 0;
}
</pre>
            <p>Then run this program and put a literal script on the command line.</p>
            <pre class="ui code segment">
./main "print('Hello World')"
</pre><a id="module"></a>
            <h3>Evaluate a Script Module</h3>
            <p>To create an application that can load and evaluate compiled script module files, use the
            <b>ejsEvalModule</b> API.</p>
            <pre class="ui code segment">
#include    "ejs/ejs.h"
int main(int argc, char **argv) 
{
    <b>if (ejsEvalModule("test.mod") &lt; 0) {</b>
        fprintf(stderr, "Error executing test.mod\n");
        exit(1);
    }
    return 0;
}
</pre>
            <p>To build this program, you just need link with Ejscript VM library <b>libejs</b>. Here is the command
            for building such a test program called <b>main.c</b> on a MAC system.</p>
            <pre class="ui code segment">
cc -o main main.c -lejs
</pre>
            <a id="control"></a>
            <h2>Full Control Embedding</h2>
            <p>In some situations, your application may need full control over the Ejscript service. Some reasons for
            this include:</p>
            <ul>
                <li>You need to create multiple interpreter instances</li>
                <li>You want custom control over where Ejscript searches for modules</li>
                <li>You want to customize the interpreter with native types, methods or variables</li>
            </ul>
            <p>Ejscript provides a comprehensive <a href="../ref/api/ejscript.html">Ejscript Native API</a> so you can
            fully control the configuration and operation of Ejscript. The APIs allow you to create and manage
            interpreters, create types, run methods, set and get properties and interact with all the objects held by
            the interpreter.</p>
            <p>Ejscript leverages the Embedthis Portable Runtime (MPR) which is a cross-platform set of services that
            abstract the operating system. The MPR enhances the security of Ejscript by providing secure,
            high-performance, and well proven routines for managing memory, strings, lists, files, network sockets,
            http and threads. MPR APIs all begin with an <b>mpr</b> prefix whereas all Ejscript APIs begin with
            <b>ejs</b> for the VM or <b>ejsc</b> for the compiler.</p>
            <p>The sample below demonstrates the full control steps to compile and evaluate a file.</p>
            <pre class="ui code segment">
int ejsEvalFile(int fileCount, char **fileList)
{
    Ejs     *ejs;         //  Handle to an Ejscript interpreter
    int     status;
    mprCreate(0, 0, 0);
    if ((ejs = ejsCreateVM(0, 0, 0)) == 0) {
        exit(1);
    }
    mprAddRoot(ejs);
    if (ejsLoadModules(ejs, 0, 0) &lt; 0) {
        exit(2);
    } 
    if (ejsLoadScriptFile(ejs, path, NULL, 
            EC_FLAGS_NO_OUT | EC_FLAGS_DEBUG) &lt; 0) {
        ejsReportError(ejs, "Error in program");
        exit(3);
    }
    mprDestroy(MPR_EXIT_DEFAULT);
    return 0;
}
</pre>
            <p>Consult the <a href="../ref/api/ejscript.html">Ejscript Native API</a> and <a href="../ref/api/mpr.html">MPR Native API</a> for details on each API. The MPR provides a hierarchical memory
            allocation service, so calls to <b>mprFree</b> will free the MPR instance and everything allocated off the
            MPR. This includes the Ejscript service, VM, interpreter and compiler. Be sure to read the <a href="../ref/api/mpr.html#group___mpr_mem">MPR Memory Allocation Service</a> for details.</p>
            <p>See the <a href="extending.html">Extending Ejscript</a> for how to interact with the interpreter,
            objects, types, run methods, create types and properties, delete properties, throw exceptions, cast types
            and more.</p>

    </div>
    <div class="terms ui basic center aligned segment">
        <p>&copy; Embedthis Software. All rights reserved.</p>
    </div>

    <script src="../lib/jquery/jquery.min.js"></script>
    <script src="../lib/jquery/jquery.slim.min.js"></script>
    <script src="../lib/semantic-ui/semantic.min.js"></script>
     

    




